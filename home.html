<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Homebrew Terminal</title>
    <!-- Pixel font -->
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        html, body {
            height: 100%;
            margin: 0;
            background-color: #000000;
            color: #39FF14;
            font-family: 'Press Start 2P', monospace;
            font-size: 14px;
        }

        body {
            display: flex;
            flex-direction: column;
        }

        .terminal {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            padding: 20px;
            box-sizing: border-box;
            overflow-y: auto;
            white-space: pre-wrap;
            line-height: 1.2;
            position: relative;
        }

        .cursor {
            display: inline-block;
            width: 10px;
            height: 1em;
            background-color: #39FF14;
            animation: blink 1s step-start infinite;
        }

        @keyframes blink {
            50% { background-color: transparent; }
        }

        .input-line {
            display: flex;
            position: relative;
        }

        .prompt {
            margin-right: 5px;
        }

        input {
            background: none;
            border: none;
            color: #39FF14;
            outline: none;
            font-family: 'Press Start 2P', monospace;
            font-size: 14px;
            flex: 1;
        }

        /* Dropdown menu */
        .dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            background: #000;
            border: 1px solid #39FF14;
            margin-top: 2px;
            z-index: 10;
            display: none;
            flex-direction: column;
        }

        .dropdown-item {
            padding: 4px 8px;
            cursor: pointer;
        }

        .dropdown-item:hover,
        .dropdown-item.active {
            background: #39FF14;
            color: #000;
        }
    </style>
</head>
<body>
    <div class="terminal" id="terminal">
        <p>Welcome to Homebrew Terminal!</p>
        <p>Type 'help' to see available commands.</p>

        <div class="input-line" id="currentLine">
            <span class="prompt">user@homebrew:~$</span>
            <input type="text" id="commandInput" autofocus />
            <span class="cursor"></span>
            <div class="dropdown" id="dropdown"></div>
        </div>
    </div>

    <script>
        const terminal = document.getElementById("terminal");
        let dropdown = document.getElementById("dropdown");
        let input = document.getElementById("commandInput");

        const availableCommands = ["help", "about", "clear"];
        let commandHistory = [];
        let historyIndex = -1;
        let dropdownIndex = -1;

        input.addEventListener("keydown", function(event) {
            if (event.key === "Enter") {
                processCommand(input.value);
                hideDropdown();
            } else if (event.key === "ArrowUp") {
                if (dropdown.style.display === "flex") navigateDropdown(-1);
                else if (commandHistory.length > 0) {
                    historyIndex = (historyIndex <= 0) ? commandHistory.length - 1 : historyIndex - 1;
                    input.value = commandHistory[historyIndex];
                }
                event.preventDefault();
            } else if (event.key === "ArrowDown") {
                if (dropdown.style.display === "flex") navigateDropdown(1);
                else if (commandHistory.length > 0) {
                    historyIndex = (historyIndex >= commandHistory.length - 1) ? 0 : historyIndex + 1;
                    input.value = commandHistory[historyIndex];
                }
                event.preventDefault();
            } else if (event.key === "Tab") {
                event.preventDefault();
                handleTabAutocomplete();
            }
        });

        input.addEventListener("input", function() {
            if (input.value.trim() === "") hideDropdown();
            else showDropdown(input.value.trim());
        });

        function processCommand(commandValue) {
            const command = commandValue.trim().toLowerCase();

            if (commandValue.trim() !== "") {
                commandHistory.push(commandValue);
                historyIndex = commandHistory.length;
            }

            const executedLine = document.createElement("div");
            executedLine.textContent = "user@homebrew:~$ " + commandValue;
            terminal.insertBefore(executedLine, document.getElementById("currentLine"));

            const output = document.createElement("div");
            if (command === "help") {
                output.textContent = "Available commands: " + availableCommands.join(", ");
            } else if (command === "about") {
                output.textContent = "This is a homebrew terminal-style website with neon green text!";
            } else if (command === "clear") {
                terminal.innerHTML = "";
                terminal.appendChild(createNewInputLine());
                scrollToBottom();
                return;
            } else if (command.length > 0) {
                output.textContent = "Command not found: " + command;
            }

            if (output.textContent) terminal.insertBefore(output, document.getElementById("currentLine"));
            input.value = "";
            scrollToBottom();
        }

        function createNewInputLine() {
            const newLine = document.createElement("div");
            newLine.className = "input-line";
            newLine.id = "currentLine";

            const prompt = document.createElement("span");
            prompt.className = "prompt";
            prompt.textContent = "user@homebrew:~$";

            const newInput = document.createElement("input");
            newInput.type = "text";
            newInput.id = "commandInput";
            newInput.autofocus = true;

            const cursor = document.createElement("span");
            cursor.className = "cursor";

            const newDropdown = document.createElement("div");
            newDropdown.className = "dropdown";
            newDropdown.id = "dropdown";

            newLine.appendChild(prompt);
            newLine.appendChild(newInput);
            newLine.appendChild(cursor);
            newLine.appendChild(newDropdown);

            input = newInput;
            dropdown = newDropdown;
            dropdownIndex = -1;

            newInput.addEventListener("keydown", function(event) {
                if (event.key === "Enter") processCommand(newInput.value);
                else if (event.key === "Tab") { event.preventDefault(); handleTabAutocomplete(); }
                else if (event.key === "ArrowUp" || event.key === "ArrowDown") event.preventDefault();
            });

            newInput.addEventListener("input", function() {
                if (newInput.value.trim() === "") hideDropdown();
                else showDropdown(newInput.value.trim());
            });

            return newLine;
        }

        function handleTabAutocomplete() {
            const filter = input.value.trim();
            const matches = availableCommands.filter(cmd => cmd.startsWith(filter.toLowerCase()));

            if (matches.length === 1) {
                input.value = matches[0]; // Auto-complete if only one match
                hideDropdown();
            } else if (matches.length > 1) {
                showDropdown(filter); // Show dropdown if multiple matches
            }
        }

        function showDropdown(filter = "") {
            dropdown.innerHTML = "";
            const filtered = availableCommands.filter(cmd => cmd.startsWith(filter.toLowerCase()));

            if (filtered.length === 0) {
                hideDropdown();
                return;
            }

            filtered.forEach((cmd, i) => {
                const item = document.createElement("div");
                item.textContent = cmd;
                item.className = "dropdown-item";
                item.addEventListener("click", () => {
                    input.value = cmd;
                    hideDropdown();
                    input.focus();
                });
                dropdown.appendChild(item);
            });

            dropdown.style.display = "flex";
            dropdown.style.flexDirection = "column";
            dropdownIndex = -1;
        }

        function hideDropdown() {
            dropdown.style.display = "none";
            dropdownIndex = -1;
        }

        function navigateDropdown(direction) {
            const items = dropdown.querySelectorAll(".dropdown-item");
            if (items.length === 0) return;

            if (dropdown.style.display !== "flex") showDropdown(input.value.trim());

            dropdownIndex += direction;
            if (dropdownIndex < 0) dropdownIndex = items.length - 1;
            if (dropdownIndex >= items.length) dropdownIndex = 0;

            items.forEach((item, i) => item.classList.toggle("active", i === dropdownIndex));
            input.value = items[dropdownIndex].textContent;
        }

        function scrollToBottom() {
            terminal.scrollTop = terminal.scrollHeight;
        }

        scrollToBottom();
    </script>
</body>
</html>
